<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Mangrove Watch - Login</title>
  
  <style>
/* General body styling */
body {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    height: 100vh;
    margin: 0;
    padding: 0;
    font-family: 'Poppins', sans-serif;
    background: url('https://konten.usu.ac.id/storage/posts/25032/dedication-restorasi-mangrove--sepotong-tindakan-untuk-keberlangsungan-kehidupan-tjo.webp') no-repeat center center/cover;
    position: relative;
    overflow: hidden;
}

/* Dark overlay */
body::before {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: -1;
}

/* Header Styling */
header {
    font-family: 'Arial Black', sans-serif;
    color: #ffffff;
    font-size: 60px;
    margin: 20px;
    text-align: center;
    text-shadow: 2px 2px 10px rgba(0,0,0,0.8);
    animation: slideDown 1s ease forwards;
}

/* Slide down animation for header */
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-50px);}
    to { opacity: 1; transform: translateY(0);}
}

/* Glassmorphic container */
.login-container {
    backdrop-filter: blur(15px);
    background: rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    padding: 50px 35px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.5);
    width: 90%;
    max-width: 450px;
    margin: 20px;
    border: 1px solid rgba(255, 255, 255, 0.25);
    animation: fadeInUp 1s ease forwards;
    transform: translateY(20px);
}

/* Fade-in and slide-up animation */
@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px);}
    to { opacity: 1; transform: translateY(0);}
}

.login-container h1 {
    color: #e0f7da;
    text-align: center;
    margin-bottom: 30px;
    font-size: 34px;
    letter-spacing: 1px;
    text-shadow: 1px 1px 6px rgba(0,0,0,0.6);
}

/* Floating input effect */
.login-container input,
.login-container select {
    font-size: 16px;
    width: 100%;
    padding: 18px 12px;
    margin: 15px 0;
    border: none;
    border-radius: 12px;
    background: rgba(255,255,255,0.25);
    color: #fff;
    box-shadow: inset 0 4px 6px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
}

.login-container input::placeholder,
.login-container select {
    color: #e0f7da;
    opacity: 0.8;
}

.login-container input:focus,
.login-container select:focus {
    outline: none;
    background: rgba(255,255,255,0.35);
    box-shadow: 0 0 10px rgba(42, 89, 52, 0.7), inset 0 4px 6px rgba(0,0,0,0.2);
    transform: scale(1.02);
}

/* Gradient button with hover animation */
.login-container button {
    width: 100%;
    padding: 15px;
    background: linear-gradient(135deg, #2a5934, #4caf50);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 18px;
    margin: 25px 0;
    transition: all 0.4s ease;
    box-shadow: 0 8px 15px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.login-container button::after {
    content: "";
    position: absolute;
    left: -50%;
    top: 0;
    width: 50%;
    height: 100%;
    background: rgba(255,255,255,0.2);
    transform: skewX(-25deg);
    transition: all 0.5s ease;
}

.login-container button:hover::after {
    left: 150%;
}

.login-container button:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 20px rgba(0,0,0,0.4);
}

/* Signup link */
.signup {
    margin-top: 10px;
    font-size: 15px;
    text-align: center;
    color: #d4d4d4;
}

.signup a {
    color: #a8e6a3;
    text-decoration: none;
    font-weight: 600;
    transition: 0.3s;
}

.signup a:hover {
    color: #76c17f;
    text-decoration: underline;
}

/* Hide signup form initially */
#signupForm {
    display: none;
}

/* Responsive design */
@media (max-width: 600px) {
    header {
        font-size: 42px;
        margin: 10px;
    }

    .login-container {
        padding: 35px 25px;
    }

    .login-container h1 {
        font-size: 28px;
    }
}
</style>


</head>

<body>
<header>Mangrow</header>
  
  <!-- LOGIN FORM -->
  <div class="login-container" id="loginForm">
    <h1>LOGIN</h1>
    <select id="role">
      <option value="" disabled selected>Login As:</option>
      <option value="community">Coastal Community</option>
      <option value="ngo">NGO</option>
      <option value="government">Government Dept</option>
      <option value="researcher">Researcher</option>
    </select>

    <input type="text" placeholder="Username" id="username" name="Username">
    <input type="password" placeholder="Password" id="password" name="Password">

    <button onclick="login()">Login</button>

    <div class="signup">
      Don't have an account? <a onclick="showSignup()">Sign up</a>
    </div>
  </div>

  <!-- SIGNUP FORM -->
  <div class="login-container" id="signupForm">
    <h1>SIGN UP</h1>
    <select id="signupRole">
      <option value="" disabled selected>Sign Up As:</option>
      <option value="community">Coastal Community</option>
      <option value="ngo">NGO</option>
      <option value="government">Government Dept</option>
      <option value="researcher">Researcher</option>
    </select>

    <input type="text" placeholder="Full Name" id="signupName" name="Full Name">
    <input type="text" placeholder="Username" id="signupUsername" name="Username">
    <input type="email" placeholder="Email" id="signupEmail" name="Email">
    <input type="password" placeholder="Password" id="signupPassword" name="Password">

    <button onclick="signup()">Sign Up</button>

    <div class="signup">
      Already have an account? <a onclick="showLogin()">Login</a>
    </div>
  </div>
 
<script>
const API_BASE = "http://localhost:5000/api/users";

// Show Signup
function showSignup() {
  document.getElementById("loginForm").style.display = "none";
  document.getElementById("signupForm").style.display = "block";
}

// Show Login
function showLogin() {
  document.getElementById("signupForm").style.display = "none";
  document.getElementById("loginForm").style.display = "block";
}

// LOGIN FUNCTION
async function login() {
  const email = document.getElementById("username").value;
  const password = document.getElementById("password").value;

  if (!email || !password) {
    alert("Please fill all fields!");
    return;
  }

  try {
    const response = await fetch(`${API_BASE}/login`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password }),
    });

    const data = await response.json();

    if (response.ok) {
      alert("Login successful!");
      localStorage.setItem("token", data.token);
      localStorage.setItem("user", JSON.stringify(data));

      // Redirect based on role returned by backend
      switch (data.role) {
        case "community":
          window.location.href = "community_dashboard.html";
          break;
        case "ngo":
          window.location.href = "ngo_dashboard.html";
          break;
        case "government":
          window.location.href = "government_dashboard.html";
          break;
        case "researcher":
          window.location.href = "researcher_dashboard.html";
          break;
        default:
          window.location.href = "community_dashboard.html";
      }
    } else {
      alert(data.msg || "Invalid login credentials");
    }
  } catch (error) {
    alert("Server error. Try again later.");
    console.error(error);
  }
}

// SIGNUP FUNCTION
async function signup() {
  const role = document.getElementById("signupRole").value;
  const name = document.getElementById("signupName").value;
  const email = document.getElementById("signupEmail").value;
  const password = document.getElementById("signupPassword").value;

  if (!role || !name || !email || !password) {
    alert("Please fill all signup fields!");
    return;
  }

  try {
    const response = await fetch(`${API_BASE}/register`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, password, role }),
    });

    const data = await response.json();

    if (response.ok) {
      alert("Signup successful! Please log in.");
      showLogin();
    } else {
      alert(data.msg || "Signup failed");
    }
  } catch (error) {
    alert("Server error. Try again later.");
    console.error(error);
  }
}
</script>




</body>
</html>
